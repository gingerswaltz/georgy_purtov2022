<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>График</title>
<style>
    canvas {
        border: 1px solid #000;
    }
</style>
</head>
<body>
<canvas id="chartCanvas" width="600" height="400"></canvas>
<script>
    var canvas = document.getElementById('chartCanvas');
    var ctx = canvas.getContext('2d');
    var data = [20, 40, 60, 80, 100]; // Исходные данные массива

    // Функция для отрисовки гистограммы
    function drawChart(data) {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Оси координат
        ctx.beginPath();
        ctx.moveTo(50, 0);
        ctx.lineTo(50, canvas.height - 50);
        ctx.lineTo(canvas.width, canvas.height - 50);
        ctx.stroke();

        // Отметки данных по оси Y
        var maxValue = Math.max.apply(null, data);
        for (var i = 0; i <= 10; i++) {
            var y = canvas.height - 50 - (i / 10) * (canvas.height - 100);
            ctx.beginPath();
            ctx.moveTo(45, y);
            ctx.lineTo(50, y);
            ctx.stroke();
            ctx.fillText((maxValue * i / 10).toFixed(0), 20, y);
        }

        var barWidth = (canvas.width - 50) / data.length;

        for (var i = 0; i < data.length; i++) {
            var barHeight = (data[i] / maxValue) * (canvas.height - 100); // Масштабируем высоту столбца
            var x = 50 + i * barWidth;
            var y = canvas.height - 50 - barHeight;
            ctx.fillStyle = '#0095DD';
            ctx.fillRect(x, y, barWidth, barHeight);
        }
    }

    // Инициализация графика с данными
    drawChart(data);

    // Функция для обновления данных графика
    function updateChartData(newData) {
        data = newData;
        console.log('Данные графика обновлены:', newData);
        drawChart(newData);
    }

    // Добавляем обработчики событий для рисования линии на графике
    var isDrawing = false;
    var startX, startY;

    canvas.addEventListener('mousedown', function(event) {
        isDrawing = true;
        startX = event.clientX - canvas.offsetLeft;
        startY = event.clientY - canvas.offsetTop;
    });

    canvas.addEventListener('mousemove', function(event) {
        if (isDrawing) {
            var mouseX = event.clientX - canvas.offsetLeft;
            var mouseY = event.clientY - canvas.offsetTop;

            var column = Math.floor((mouseX - 50) / ((canvas.width - 50) / data.length));

            var distanceX = Math.abs(mouseX - startX);
            var distanceY = Math.abs(mouseY - startY);
            var distance = Math.sqrt(distanceX * distanceX + distanceY * distanceY);

            var changeValue = Math.round(distance / 10); // Определяем изменение значения в зависимости от расстояния

            if (changeValue === 0) {
                changeValue = 1; // Минимальное изменение
            }

            if (mouseY < canvas.height - (data[column] / Math.max.apply(null, data)) * (canvas.height - 100)) {
                data[column] += changeValue;
            } else if (data[column] >= changeValue) {
                data[column] -= changeValue;
            }

            drawChart(data);

            startX = mouseX;
            startY = mouseY;
        }
    });

    canvas.addEventListener('mouseup', function(event) {
        if (isDrawing) {
            isDrawing = false;
            updateChartData(data);
        }
    });

    canvas.addEventListener('mouseout', function(event) {
        if (isDrawing) {
            isDrawing = false;
            updateChartData(data);
        }
    });
</script>
</body>
</html>
